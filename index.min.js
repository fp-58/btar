(()=>{class e{#e=new Map;#t=[];t(e,n,i){e.endsWith("/")&&(e=e.substring(0,e.length-1));const r=e.lastIndexOf("/"),o=t(e.substring(r+1),i?.mode??420,i?.i??0,i?.o??0,n.size,n.lastModified,-1,0,"",0,i?.u??"",i?.l??"",0,0,e.substring(0,r+1));this.#e.set(e,this.#t.length),this.#t.push({h:o,content:n})}static async p(a){const s=512;let c=0;const f=new e;for(let e=await u();e;e=await u()){let t=c*s,i=t+e.size;if(a.size<i)throw Error(`Malformed archive: Expected size ${i}, got size ${a.size}`);let r,o=e.prefix+e.name;if(o.endsWith("/")){let e=o.substring(0,o.length-1),t=e.lastIndexOf("/");r=e.substring(t)}else{let e=o.lastIndexOf("/");r=o.substring(e)}const u=new n([a.slice(t,i)],r,o,{lastModified:e.lastModified,m:"transparent"});f.#e.set(o,f.#t.length),f.#t.push({h:e,content:u}),c+=Math.ceil(e.size/s)}async function u(){const e=await async function(){const e=await l();a.size-c*s>-512&&c++;return e}();if(o(e)){if(o(await l()))return null}return t(i(e,0,100),r(e,100,8),r(e,108,8),r(e,116,8),r(e,124,12),r(e,136,12),r(e,148,8),r(e,156,1),i(e,157,100),r(e,263,3),i(e,265,32),i(e,297,32),r(e,329,8),r(e,337,8),i(e,345,155))}async function l(){let e=c*c,t=e+s;if(a.size<e)return new Uint8Array(512);if(a.size<t){const t=new Uint8Array(512),n=a.slice(e),i=new Uint8Array(await n.arrayBuffer());return t.set(i),t}{const n=a.slice(e,t);return new Uint8Array(await n.arrayBuffer())}}}}function t(e,t,n,i,r,o,a,s,c,f,u,l,d,w,h){return{name:e,mode:t,i:n,o:i,size:r,lastModified:o,v:a,A:s,M:c,version:f,u,l,U:d,k:w,prefix:h}}class n extends File{#n;constructor(e,t,n,i){super(e,t,i),this.#n=n}get webkitRelativePath(){return this.#n}}function i(e,t=0,n=e.length-t){e=new Uint8Array(e,t,n);const i=new TextDecoder;for(let t=0;t<n;t++)if(0===e[t]){e=e.subarray(0,t);break}return i.decode(e)}function r(e,t,n){e=new Uint8Array(e,t,n);let i=0;for(const t of e){if(0===t)break;i<<=3,t<49||55<t||(i|=t-48)}return i}function o(e){return e.every((e=>0===e))}"function"==typeof define&&define.amd?define((function(){return{TarArchive:e}})):"object"==typeof module&&module?module.exports.TarArchive=e:"object"==typeof exports&&exports?exports.TarArchive=e:"object"==typeof window&&window?window.TarArchive=e:globalThis.TarArchive=e})();